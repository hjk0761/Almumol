# Info
[상품권 준비](https://boj.kr/19588)

- 난이도: 플래 5
- 분류: 그리디 알고리즘, 정렬, 누적 합

## 💡 풀이 방법 요약

개념 자체는 어렵진 않았지만 시간 복잡도가 쉽지 않은 문제였습니다.

일단 XOR 에 대한 여러 성질을 알아야 풀 수 있습니다.

먼저 a^0=a, a^a=0 임을 알아야 합니다. 또한 교환법칙이 성립하기 때문에 a^b^a = a^a^b = 0^b = b가 된다는 사실을 이용해야 합니다.

이를 이용하면 누적합과 비슷하게, XOR 도 누적을 구해서 O(1)에 구간에서의 XOR 을 구할 수 있습니다.

이 누적XOR이 코드에 dp 입니다.

여기서 m개의 a마다 잘라서 구하면 되겠다고 생각할 수 있겠지만, 이 문제의 시간 제한은 2초이고 쿼리는 최대 500,000개 이기 때문에 한 쿼리 결과를 O(n)으로 구하게 되면 시간 초과입니다.

이를 줄이기 위한 방법을 생각하기 어려웠는데, 조금의 힌트를 얻어 풀 수 있었습니다.

방법은 바로 m명으로 이루어진 a그룹을 미리 구해두는 겁니다. 좀 더 자세하게, b에 따라서 묶이는 팀의 멤버가 달라지는데 이를 미리 구해두는 것입니다.

`0`부터 `m-1`까지(`b<N`이고 쿼리는 팀을 이루는 경우가 있는 입력만 주어지므로 최소 한 명 이상은 참여 후보가 된다) 가 출제진이 가능한 경우의 수이라는 것을 알 수 있습니다.

따라서 각 경우에 대해 출제진만큼 뒤에서 제외한 후, 뒤에서부터 a명씩 묶어서 미리 누적 XOR을 구하면 됩니다. 이 값은 이전에 구한 누적XOR을 통해 O(1)로 구할 수 있고, 이후 이 값을 누적해서 더하면 문제에서 요구하는 m명으로 이루어진 (n//m)개의 팀의 XOR 합을 구해둘 수 있습니다.

이렇게 구한 누적합 계산을 통해 O(1)으로 b명의 출제진을 제외하고 a개의 팀의 XOR 합을 구할 수 있습니다!

앞서 설명했어야 했지만, 최강의 팀 구성은 실력이 큰 순으로 a명씩 잘라서 팀을 이루는 게 최선의 방법입니다.

간단하게 `a >= b >= c >= d`의 경우에서 `a*b + c*d`의 경우가 가장 큰 조합임을 증명할 수 있고, 이를 2n개의 정수에서도 성립함을 증명할 수 있습니다.

## 👀 실패 이유

b가 m보다 클 수 있다는 사실을 생각하지 못해서 dp2 테이블에 대해서 인덱스 에러가 발생했습니다.

## 🙂 마무리

12시 전에 풀고 싶었는데 인덱스 에러가 생겨서 12시를 넘겨버렸습니다...

그래서 백준 스트릭은 끊겼지만 솔브닥 스트릭은 자정 기준이 아니라 연장이 되네요 ㅋ.ㅋ
